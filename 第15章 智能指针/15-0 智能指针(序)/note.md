# PART1. 相关概念

- 指针: 一个变量在内存中包含的是一个地址(该地址指向其他数据)
- Rust中最常见的指针是"引用"
- 引用:
  - 使用`&`
  - 借用它指向的值
  - 没有其他的开销
  - 是最常见的指针类型

# PART2. 智能指针

智能指针是这样的数据结构:

- 行为和指针类似
- 有额外的元数据和功能

# PART3. 引用计数(reference counting)智能指针类型

- 通过计数所有者的数量,使得1份数据被多个所有者同时拥有
- 在没有任何所有者时自动清理数据

# PART4. 引用和智能指针的其他不同

- 引用: 只借用数据
- 智能指针: 很多时候都拥有它所指向的数据

# PART5. 智能指针的例子

- `String`和`Vec<T>`
- 它们都拥有一片内存区域,且都允许用户对这片内存区域进行操作
- 都拥有元数据
  - 例如容量,长度等
- 都提供了额外的功能或保障
  - 例如`String`会保障其数据都是合法的UTF-8编码

# PART6. 智能指针的实现

- 智能指针通常使用struct来实现
- 通常都会实现Deref和Drop这2个trait
- Deref trait: 允许智能指针struct的实例像引用一样使用
  - 这就允许你编写出可以同时使用引用和智能指针的代码
- Drop trait: 允许你自定义当智能指针实例走出作用域时的代码

# PART7. 本章内容

- 介绍标准库中常见的智能指针
  - `Box<T>`: 在heap内存上分配值
  - `Rc<T>`: 启用多重所有权的引用计数类型
  - `Ref<T>`和`RefMut<T>`: 通过`RefCell<T>`访问. 允许在运行时而不是在编译时执行借用规则的检查

此外:

- 内部可变模式(Interior Mutability Pattern): 不可变类型暴露出可修改其内部值的API
- 循环引用(Reference Cycles): 它们是如何泄露内存,以及如何防止其意外发生